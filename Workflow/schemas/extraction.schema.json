{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "extraction.schema.json",
  "title": "Extraction Output",
  "description": "Structured data extracted from transcripts/emails",
  "type": "object",
  "required": ["source_file", "processed_at", "classification", "extraction"],
  "properties": {
    "source_file": {
      "type": "string",
      "description": "Path to original source file"
    },
    "processed_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO-8601 timestamp of extraction"
    },
    "classification": {
      "type": "object",
      "required": ["note_type"],
      "properties": {
        "note_type": {
          "type": "string",
          "enum": ["customer", "people", "projects", "rob", "journal", "partners", "travel"]
        },
        "entity_name": {
          "type": "string",
          "description": "Primary entity (person, project, account)"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "sub_type": {
          "type": "string",
          "description": "Optional sub-classification (e.g., technical, leadership)"
        }
      }
    },
    "extraction": {
      "type": "object",
      "required": ["title", "date", "participants"],
      "properties": {
        "title": {
          "type": "string",
          "description": "Generated note title"
        },
        "date": {
          "type": "string",
          "format": "date",
          "description": "Meeting/email date (YYYY-MM-DD)"
        },
        "participants": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of people involved"
        },
        "summary": {
          "type": "string",
          "description": "Brief summary of content"
        },
        "tasks": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["text"],
            "properties": {
              "text": { "type": "string" },
              "owner": { "type": "string", "default": "Myself" },
              "due": { "type": "string", "format": "date" },
              "priority": { 
                "type": "string", 
                "enum": ["highest", "high", "medium", "low", "lowest"]
              }
            }
          }
        },
        "decisions": {
          "type": "array",
          "items": { "type": "string" }
        },
        "facts": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Key facts or context to remember"
        },
        "mentions": {
          "type": "object",
          "properties": {
            "people": { "type": "array", "items": { "type": "string" } },
            "projects": { "type": "array", "items": { "type": "string" } },
            "accounts": { "type": "array", "items": { "type": "string" } }
          }
        },
        "notes": {
          "type": "string",
          "description": "Additional notes or raw content"
        }
      }
    }
  }
}
